<div class="login-page">
  <form [formGroup]="loginForm" (ngSubmit)="onLoginSubmit()">
    <div class="login-container">
      <div class="form-header">
        <a routerLink="/">
          <img src="assets/CarComps_Logo_C_white.png" alt="CarComps Logo" class="logo" />
        </a>
        <h2>Bejelentkezés</h2>
      </div>

      <div class="email-control">
        <input
          type="email"
          class="form__field"
          [class.invalid]="emailIsInvalid"
          placeholder="Email"
          id="email"
          [formControl]="loginForm.controls.email"
        />
        <label for="email" class="form__label">Email</label>
        @if (emailIsInvalid) {
          <p class="error-message">Hibás email cím</p>
        }
      </div>

      <div class="login-control">
        <input
          type="password"
          class="form__field"
          [class.invalid]="passwordIsInvalid"
          placeholder="Jelszó"
          id="password"
          formControlName="password"
        />
        <label for="password" class="form__label">Jelszó</label>
        <div class="forgot-password-container">
          <a routerLink="/forgot-password">Elfelejtetted a jelszavad?</a>
        </div>
        @if (passwordIsInvalid) {
          <p class="error-message">Adja meg a jelszavát!</p>
        }
      </div>

      @if (loginFailed()) {
        <div class="login-error-banner">
          <i class="fa-solid fa-circle-exclamation"></i>
          <p>Hibás email vagy jelszó!</p>
        </div>
      }

      <div class="chapta">
        <label class="chapta-container">
          <input type="checkbox" />
          <span class="checkmark"></span>
          <span class="chapta-text">Nem vagyok robot</span>
          <img src="assets/rechapta.png" alt="reCAPTCHA" class="recaptcha-logo" />
        </label>
      </div>
    </div>

    <button type="submit" class="button" [disabled]="loginForm.invalid">Bejelentkezés</button>

    <p>
      Nincs még fiókod?
      <a routerLink="/registration" class="reg-link">Regisztrálj egy újat!</a>
    </p>
  </form>
</div>

<!-- ⭐ OTP DIALOG -->
<app-otp-dialog (verified)="onOTPVerified()" (cancelled)="onOTPCancelled()"></app-otp-dialog>
